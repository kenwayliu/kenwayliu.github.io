<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>猫在云端</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="猫在云端">
<meta property="og:url" content="http://cloudbps.com/page/6/">
<meta property="og:site_name" content="猫在云端">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="猫在云端">
<meta name="twitter:description">

  
    <link rel="alternative" href="/atom.xml" title="猫在云端" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  

  <script src="http://libs.baidu.com/jquery/1.9.0/jquery.js"></script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<div class="profilepic">
			<img src="https://avatars2.githubusercontent.com/u/5484331?v=3&amp;s=150">
		</div>

		<hgroup>
		  <h1 class="header-author"><a href="/">Tom.liu</a></h1>
		</hgroup>

		
		<p class="header-subtitle">做自己喜欢做的事，相信自己</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="/#" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/cloudbps" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud">
						<a href="/tags/IAAS/" style="font-size: 20.00px;">IAAS</a><a href="/tags/Linux常用工具/" style="font-size: 10.00px;">Linux常用工具</a><a href="/tags/Mac添加路由/" style="font-size: 10.00px;">Mac添加路由</a><a href="/tags/NTP时间/" style="font-size: 10.00px;">NTP时间</a><a href="/tags/VPN/" style="font-size: 10.00px;">VPN</a><a href="/tags/WEB服务器/" style="font-size: 13.33px;">WEB服务器</a><a href="/tags/分布式系统/" style="font-size: 10.00px;">分布式系统</a><a href="/tags/系统安全/" style="font-size: 16.67px;">系统安全</a><a href="/tags/缓存加速/" style="font-size: 10.00px;">缓存加速</a><a href="/tags/脚本语言/" style="font-size: 13.33px;">脚本语言</a><a href="/tags/调优手册/" style="font-size: 10.00px;">调优手册</a><a href="/tags/运维自动化/" style="font-size: 10.00px;">运维自动化</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://zipperary.com/">Zippera的Blog</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://kisspuppet.com/">Puppet运维自动化技术分享</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.xuchanggang.cn/">没有伞的孩子必须努力奔跑</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://bubbyroom.com/">守住每一天</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://opython.com/">Python自动化运维</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.aikaiyuan.com/">爱开源</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://noops.me/">小米运维</a>
			        
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					喜欢交流,喜欢开源
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay"></div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="https://avatars2.githubusercontent.com/u/5484331?v=3&amp;s=150">
			</div>

			<hgroup>
			  <h1 class="header-author"><a href="/">Tom.liu</a></h1>
			</hgroup>
			
			<p class="header-subtitle">做自己喜欢做的事，相信自己</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="/#" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/cloudbps" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      
  
    <article id="post-screen" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2013/06/07/screen/" class="article-date">
  	<time datetime="2013-06-07T11:44:33.000Z" itemprop="datePublished">6月 7 2013</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux-Tools/">Linux Tools</a>
  </div>

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux常用工具/">Linux常用工具</a></li></ul>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2013/06/07/screen/">Screen</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="一-screen简介">一.screen简介</h4>
<p>1.用于后台不间断操作,常用与测试.数据临时备份等相关的操作</p>
<h4 id="二-screen_vs_nohub">二.screen vs nohub</h4>
<p>nohub 执行命令后是直接丢到后台运行,退出后无法通过父进程链接</p>
<p>如果我们使用screen可以随时登录和登出当前shell<br>
        
          <p class="article-more-link">
            <a href="/2013/06/07/screen/#more">more >></a>
          </p>
        
      
    </div>
  </div>
  
</article>






  
    <article id="post-ssh_recent" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2013/03/10/ssh_recent/" class="article-date">
  	<time datetime="2013-03-10T14:00:33.000Z" itemprop="datePublished">3月 10 2013</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux-Secure/">Linux Secure</a>
  </div>

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/系统安全/">系统安全</a></li></ul>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2013/03/10/ssh_recent/">远程密令开启ssh服务</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li>linux服务器，我们一般是通过ssh通道远程管理，这就需要我们开启ssh端口，如22。但开启端口有被暴力破解的风险，你会说可以设置复杂的密码或使用证书避免。就算破解不了密码，但openssh也可能会有漏洞，你会说可以更改ssh端口，但还是有可能被扫描出来。还有一种选择，我们可以只允许指定IP访问ssh，通过vpn登录管理服务器，但局限很明显，万一紧急情况vpn登录不上去了怎么办。下面给出一种个人觉得比较满意的解决方案，即使用iptables的recent模块，通过密令临时开启ssh端口。当然，密令需要保管好，防止外泄。</li>
</ul>
<p>1、iptables规则设定</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#指定78字节的icmp数据包(包含IP头部20字节，ICMP头部8字节)通过被加入sshopen列表。</span></div><div class="line">iptables -<span class="constant">A</span> <span class="constant">INPUT</span> -p icmp --icmp-type <span class="number">8</span> -m length --length <span class="number">78</span> -m recent --set --name sshopen --rsource -j <span class="constant">ACCEPT</span></div><div class="line"><span class="comment">#检查sshopen列表是否存在你的来源IP，如果存在，即从第一次使用密令开始15秒钟内开启ssh端口22,超过15秒端口自动关闭，不再允许新连接，已连接的不会断开。</span></div><div class="line">iptables -<span class="constant">A</span> <span class="constant">INPUT</span> -p tcp --dport <span class="number">22</span> --syn -m recent --rcheck --seconds <span class="number">15</span> --name sshopen --rsource -j <span class="constant">ACCEPT</span></div></pre></td></tr></table></figure>

<p>2、通过icmp包开启ssh</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">linux下<span class="symbol">:ping</span> -s <span class="number">50</span> host</div><div class="line">windows下<span class="symbol">:ping</span> -l <span class="number">50</span> host</div></pre></td></tr></table></figure>

<p>
        
          <p class="article-more-link">
            <a href="/2013/03/10/ssh_recent/#more">more >></a>
          </p>
        
      
    </div>
  </div>
  
</article>






  
    <article id="post-ssh_config" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2013/03/10/ssh_config/" class="article-date">
  	<time datetime="2013-03-10T13:51:00.000Z" itemprop="datePublished">3月 10 2013</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux-Secure/">Linux Secure</a>
  </div>

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/系统安全/">系统安全</a></li></ul>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2013/03/10/ssh_config/">sshd_config</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="ssh_config配置详解">ssh_config配置详解</h2>
<h5 id="1-_关于_SSH_Server_的整体设定，包含使用的_port_啦，以及使用的密码演算方式">1. 关于 SSH Server 的整体设定，包含使用的 port 啦，以及使用的密码演算方式</h5>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="constant">Port</span> <span class="number">22</span>　　　　　　　　　　<span class="comment"># SSH 预设使用 22 这个 port，您也可以使用多的 port ！</span></div><div class="line">　　　　　　　　　　　　　 <span class="comment"># 亦即重复使用 port 这个设定项目即可！</span></div><div class="line"><span class="constant">Protocol</span> <span class="number">2</span>,<span class="number">1</span>　　　　　　　 <span class="comment"># 选择的 SSH 协议版本，可以是 1 也可以是 2 ，</span></div><div class="line">　　　　　　　　　　　　　 <span class="comment"># 如果要同时支持两者，就必须要使用 2,1 这个分隔了！</span></div><div class="line"><span class="constant">ListenAddress</span> <span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>　　 <span class="comment"># 监听的主机适配卡！举个例子来说，如果您有两个 IP，</span></div><div class="line">　　　　　　　　　　　　　 <span class="comment"># 分别是 192.168.0.100 及 192.168.2.20 ，那么只想要</span></div><div class="line">　　　　　　　　　　　　　 <span class="comment"># 开放 192.168.0.100 时，就可以写如同下面的样式：</span></div><div class="line"><span class="constant">PidFile</span> /var/run/sshd.pid　　　　　　<span class="comment"># 可以放置 SSHD 这个 PID 的档案！左列为默认值</span></div><div class="line"><span class="constant">LoginGraceTime</span> <span class="number">600</span>　　　　 <span class="comment"># 当使用者连上 SSH server 之后，会出现输入密码的画面，</span></div><div class="line">　　　　　　　　　　　　　 <span class="comment"># 在该画面中，在多久时间内没有成功连上 SSH server ，</span></div><div class="line">　　　　　　　　　　　　　 <span class="comment"># 就断线！时间为秒！</span></div><div class="line"><span class="constant">Compression</span> yes　　　　　　<span class="comment"># 是否可以使用压缩指令？当然可以啰！</span></div></pre></td></tr></table></figure>

<p>
        
          <p class="article-more-link">
            <a href="/2013/03/10/ssh_config/#more">more >></a>
          </p>
        
      
    </div>
  </div>
  
</article>






  
    <article id="post-ssh" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2013/03/07/ssh/" class="article-date">
  	<time datetime="2013-03-07T13:23:00.000Z" itemprop="datePublished">3月 7 2013</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux-Secure/">Linux Secure</a>
  </div>

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/系统安全/">系统安全</a></li></ul>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2013/03/07/ssh/">ssh基础篇</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>SSH-安全登录服务,主要用于远程登录管理<br>1.监听tcp的22端口<br>2.相关软件包openssh-cline,openssh-server-5.3p1-81.el6.x86_64<br>3.配置文件位置在/etc/ssh中,ssh_config是客户端配置文件,sshd_config是服务端配置文件,默认通过公私钥的方式加密<br>当客户端连接时会在本地家目录生成一个公钥</p>
<p>当我们要同时分发文件到多台服务器的时候当我们一台一台登录的时候比较麻烦.这是我们可以通过生成公私钥的方式,把公钥分发到每一台host,这样我们不用每次输入密码了,一下是步骤</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ssh-keygen   生成密钥</div><div class="line">ssh-copy-id  -i  ~<span class="regexp">/.ssh/</span>*.pub user<span class="variable">@host</span>  把生成的公钥传到客户端,这样就不用每次数据密码了.</div></pre></td></tr></table></figure>

<p>ssh常用的命令:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt"></span></span></div><div class="line">ssh user@host     登录远程主机</div><div class="line">ssh user@host   "command"   本地操作远程主机执行命令</div><div class="line">ssh user@host   "command" &gt; /tmp/     把远程服务器执行的结果重定向到本地tmp目录下</div><div class="line"><span class="input"><span class="prompt">tar cf - dir | ssh IP "cat - &gt;</span> /tmp/dir1.tar<span class="string">"   把本地的文件或者目录传输到远程服务器,并且是打包的</span></span></div><div class="line">ssh IP "tar xzf - -<span class="constant">C</span> /tmp<span class="string">" &lt; /dir/dd.tar.gz   把本地的tar包解压到远程目录</span></div><div class="line">tar cf - . |ssh root@host "tar xf - -<span class="constant">C</span> /tmp<span class="string">"  把本地的数据打包传输到远程服务器,所有的目录树结构和权限是一样的</span></div></pre></td></tr></table></figure>

<p>如果想批量执行可以这么操作</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">cat &lt;&lt;<span class="constant">END</span> |ssh <span class="constant">IP</span></div><div class="line">&gt;service httpd restart  重启httpd服务</div><div class="line">&gt;sleep <span class="number">2</span>                     停顿<span class="number">2</span>s</div><div class="line">&gt;service sshd restart    重启sshd服务</div><div class="line">&gt;<span class="constant">ENDF</span>                          退出并执行</div></pre></td></tr></table></figure>

<p>ssh转发功能,解决不加密的服务进行转发</p>
<p>ssh IP -L 2025:localhost:25    通过本地2025端口去连接远程的25号端口</p>
<p>远程执行本地脚本<br>ssh  user@localhost bash &lt; /tmp/shell.sh</p>

      
    </div>
  </div>
  
</article>






  
    <article id="post-web_conurrtn" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/0010/08/15/web_conurrtn/" class="article-date">
  	<time datetime="0010-08-15T03:42:00.000Z" itemprop="datePublished">8月 15 0010</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a>
  </div>

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WEB服务器/">WEB服务器</a></li></ul>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/0010/08/15/web_conurrtn/">WEB并发量级介绍（转自爱开源）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>评价一个网站的“大小”，处于视角的不同，有很多种衡量的方法，类似文章数，页面数之类的数据非常明显，也没有什么可以争议的。但对于并发来说，争议非常之多，这里就从一个技术的角度开始，谈谈几个Web网站的数量级。</p>
<p>相信很多人谈论一个网站的热度，总免不了会询问日均PV，同时在线人数、注册用户数等运营数据，说实话从技术角度来说，这几个数值没有一个可以放在一起比较的——一个静态网站的PV跟一个SNS类/Web Game网站的PV根本就不是一回事。由于互联网有一个传说中的“3秒定律”，可能当下更多的网站技术指标要求1.5秒以内加载整页，或者至少可以达到阅读的标准。如果要较真什么“同时在线”，毫不客气的说，对于HTTP这类短链接的网络协议来说，在WebSocket还不普及的时代，能统计在线纯属扯淡，唯一能做的只是取个时间段，计算下访问用户而已。这些依然可以换算成QPS（Quest Per Second每秒请求数）。就并发而言，我唯一推崇的只有理论最大QPS和悲观QPS。</p>
<p>这里就大致根据理论最大QPS，给网站做几个分类</p>
<p>50QPS以下——小网站</p>
<p>没什么好说的，简单的小网站而已，就如同本站这样，你可以用最简单的方法快速搭建，短期没有太多的技术瓶颈，只要服务器不要太烂就好。</p>
<p>50～100QPS——DB极限型</p>
<p>大部分的关系型数据库的每次请求大多都能控制在0.01秒左右，即便你的网站每页面只有一次DB请求，那么页面请求无法保证在1秒钟内完成100个请求，这个阶段要考虑做Cache或者多DB负载。无论那种方案，网站重构是不可避免的。</p>
<p>300～800QPS——带宽极限型</p>
<p>目前服务器大多用了IDC提供的“百兆带宽”，这意味着网站出口的实际带宽是8M Byte左右。假定每个页面只有10K Byte，在这个并发条件下，百兆带宽已经吃完。首要考虑是CDN加速／异地缓存，多机负载等技术。</p>
<p>500～1000QPS——内网带宽极限＋Memcache极限型</p>
<p>由于Key/value的特性，每个页面对memcache的请求远大于直接对DB的请求，Memcache的悲观并发数在2w左右，看似很高，但事实上大多数情况下，首先是有可能在次之前内网的带宽就已经吃光，接着是在8K QPS左右的情况下，Memcache已经表现出了不稳定，如果代码上没有足够的优化，可能直接将压力转嫁到了DB层上，这就最终导致整个系统在达到某个阀值之上，性能迅速下滑。</p>
<p>1000～2000QPS——FORK/SELECT，锁模式极限型</p>
<p>好吧，一句话：线程模型决定吞吐量。不管你系统中最常见的锁是什么锁，这个级别下，文件系统访问锁都成为了灾难。这就要求系统中不能存在中央节点，所有的数据都必须分布存储，数据需要分布处理。总之，关键词：分布</p>
<p>2000QPS以上——C10K极限</p>
<p>尽管现在很多应用已经实现了C25K，但短板理论告诉我们，决定网站整体并发的永远是最低效的那个环节。我承认我生涯中从未遇到过2000QPS以上，甚至1.5K以上的网站，希望有此经验的哥们可以一起交流下</p>

      
    </div>
  </div>
  
</article>






  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/5/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span>
    </nav>
  

      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 Tom.liu
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">

  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>

  <script src="/js/main.js" type="text/javascript"></script>


  </div>
</body>
</html>