<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>猫在云端</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="猫在云端">
<meta property="og:url" content="http://cloudbps.com/page/6/">
<meta property="og:site_name" content="猫在云端">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="猫在云端">
<meta name="twitter:description">

  
    <link rel="alternative" href="/atom.xml" title="猫在云端" type="application/atom+xml">
  
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  
</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="overlay"></div>
  <div id="header-outer" class="outer">
    <div id="profile_img">
      <img id="circle_img" src="http://7sbxwp.com1.z0.glb.clouddn.com/aboutme?v=2&amp;s=150" />
    </div>
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">猫在云端</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">做自己喜欢做的事，相信自己</a>
        </h2>
      
    </div>
    <div id="header-menu">
      <nav id="main-nav">
        <ul>
        
          <li><a href="/"><i class="fa fa-home icon-setting"></i></a></li>
        
          <li><a href="/archives"><i class="fa fa-archive icon-setting"></i></a></li>
        
          <li><a href="/about"><i class="fa fa-user icon-setting"></i></a></li>
        
        
          <li><a href="/atom.xml"><i class="fa fa-rss %> icon-setting"></i></a></li>
        
        </ul>
      </nav>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-shell" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2013/11/10/shell/" class="article-date">
  <time datetime="2013-11-10T14:16:33.000Z" itemprop="datePublished">11月 10 2013</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Shell/">Shell</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2013/11/10/shell/">Shell编程基础</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="1-shell_编程基础">1.shell 编程基础</h4>
<ul>
<li>shell:是一种解释器,提供人与机器交流的接口.</li>
<li>为社么要用shell</li>
<li>1.解决重复操作的事情</li>
<li>2.节约时间,提高工作效率</li>
<li>3.功能强大,使用简单.</li>
<li></li>
<li>查看系统注册的shell</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- cat /etc/shell</div></pre></td></tr></table></figure>

<h4 id="2-shell的基本组成元素">2.shell的基本组成元素</h4>
<ul>
<li>1.#!:表示魔法字符或者沙帮,出现在脚本的第一行,用于定义命令解释器</li>
<li>2.#:以#开头的行表示注释,这些不被运行,只是给人阅读使用.</li>
<li>3.系统命令:shell脚本中运行解释的系统命令</li>
<li>4.变量:脚本运行过程中某些反复调用的值的暂存池</li>
<li>5.流程控制语句:判断,循环,跳转等流程控制.</li>
</ul>

        
          <p class="article-more-link">
            <a href="/2013/11/10/shell/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://cloudbps.com/2013/11/10/shell/" data-id="02lur1v6qkig8sw0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/脚本语言/">脚本语言</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-screen" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2013/06/07/screen/" class="article-date">
  <time datetime="2013-06-07T11:44:33.000Z" itemprop="datePublished">6月 7 2013</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux-Tools/">Linux Tools</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2013/06/07/screen/">Screen</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="一-screen简介">一.screen简介</h4>
<p>1.用于后台不间断操作,常用与测试.数据临时备份等相关的操作</p>
<h4 id="二-screen_vs_nohub">二.screen vs nohub</h4>
<p>nohub 执行命令后是直接丢到后台运行,退出后无法通过父进程链接</p>
<p>如果我们使用screen可以随时登录和登出当前shell<br>
        
          <p class="article-more-link">
            <a href="/2013/06/07/screen/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://cloudbps.com/2013/06/07/screen/" data-id="rjqs3yx7dz228zz1" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux常用工具/">Linux常用工具</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ssh_recent" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2013/03/10/ssh_recent/" class="article-date">
  <time datetime="2013-03-10T14:00:33.000Z" itemprop="datePublished">3月 10 2013</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux-Secure/">Linux Secure</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2013/03/10/ssh_recent/">远程密令开启ssh服务</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li>linux服务器，我们一般是通过ssh通道远程管理，这就需要我们开启ssh端口，如22。但开启端口有被暴力破解的风险，你会说可以设置复杂的密码或使用证书避免。就算破解不了密码，但openssh也可能会有漏洞，你会说可以更改ssh端口，但还是有可能被扫描出来。还有一种选择，我们可以只允许指定IP访问ssh，通过vpn登录管理服务器，但局限很明显，万一紧急情况vpn登录不上去了怎么办。下面给出一种个人觉得比较满意的解决方案，即使用iptables的recent模块，通过密令临时开启ssh端口。当然，密令需要保管好，防止外泄。</li>
</ul>
<p>1、iptables规则设定</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#指定78字节的icmp数据包(包含IP头部20字节，ICMP头部8字节)通过被加入sshopen列表。</span></div><div class="line">iptables -<span class="constant">A</span> <span class="constant">INPUT</span> -p icmp --icmp-type <span class="number">8</span> -m length --length <span class="number">78</span> -m recent --set --name sshopen --rsource -j <span class="constant">ACCEPT</span></div><div class="line"><span class="comment">#检查sshopen列表是否存在你的来源IP，如果存在，即从第一次使用密令开始15秒钟内开启ssh端口22,超过15秒端口自动关闭，不再允许新连接，已连接的不会断开。</span></div><div class="line">iptables -<span class="constant">A</span> <span class="constant">INPUT</span> -p tcp --dport <span class="number">22</span> --syn -m recent --rcheck --seconds <span class="number">15</span> --name sshopen --rsource -j <span class="constant">ACCEPT</span></div></pre></td></tr></table></figure>

<p>2、通过icmp包开启ssh</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">linux下<span class="symbol">:ping</span> -s <span class="number">50</span> host</div><div class="line">windows下<span class="symbol">:ping</span> -l <span class="number">50</span> host</div></pre></td></tr></table></figure>

<p>
        
          <p class="article-more-link">
            <a href="/2013/03/10/ssh_recent/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://cloudbps.com/2013/03/10/ssh_recent/" data-id="pftqh23vxuhlatp1" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/系统安全/">系统安全</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ssh_config" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2013/03/10/ssh_config/" class="article-date">
  <time datetime="2013-03-10T13:51:00.000Z" itemprop="datePublished">3月 10 2013</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux-Secure/">Linux Secure</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2013/03/10/ssh_config/">sshd_config</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="ssh_config配置详解">ssh_config配置详解</h2>
<h5 id="1-_关于_SSH_Server_的整体设定，包含使用的_port_啦，以及使用的密码演算方式">1. 关于 SSH Server 的整体设定，包含使用的 port 啦，以及使用的密码演算方式</h5>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="constant">Port</span> <span class="number">22</span>　　　　　　　　　　<span class="comment"># SSH 预设使用 22 这个 port，您也可以使用多的 port ！</span></div><div class="line">　　　　　　　　　　　　　 <span class="comment"># 亦即重复使用 port 这个设定项目即可！</span></div><div class="line"><span class="constant">Protocol</span> <span class="number">2</span>,<span class="number">1</span>　　　　　　　 <span class="comment"># 选择的 SSH 协议版本，可以是 1 也可以是 2 ，</span></div><div class="line">　　　　　　　　　　　　　 <span class="comment"># 如果要同时支持两者，就必须要使用 2,1 这个分隔了！</span></div><div class="line"><span class="constant">ListenAddress</span> <span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>　　 <span class="comment"># 监听的主机适配卡！举个例子来说，如果您有两个 IP，</span></div><div class="line">　　　　　　　　　　　　　 <span class="comment"># 分别是 192.168.0.100 及 192.168.2.20 ，那么只想要</span></div><div class="line">　　　　　　　　　　　　　 <span class="comment"># 开放 192.168.0.100 时，就可以写如同下面的样式：</span></div><div class="line"><span class="constant">PidFile</span> /var/run/sshd.pid　　　　　　<span class="comment"># 可以放置 SSHD 这个 PID 的档案！左列为默认值</span></div><div class="line"><span class="constant">LoginGraceTime</span> <span class="number">600</span>　　　　 <span class="comment"># 当使用者连上 SSH server 之后，会出现输入密码的画面，</span></div><div class="line">　　　　　　　　　　　　　 <span class="comment"># 在该画面中，在多久时间内没有成功连上 SSH server ，</span></div><div class="line">　　　　　　　　　　　　　 <span class="comment"># 就断线！时间为秒！</span></div><div class="line"><span class="constant">Compression</span> yes　　　　　　<span class="comment"># 是否可以使用压缩指令？当然可以啰！</span></div></pre></td></tr></table></figure>

<p>
        
          <p class="article-more-link">
            <a href="/2013/03/10/ssh_config/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://cloudbps.com/2013/03/10/ssh_config/" data-id="u0n21m43zg88o24p" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/系统安全/">系统安全</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ssh" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2013/03/07/ssh/" class="article-date">
  <time datetime="2013-03-07T13:23:00.000Z" itemprop="datePublished">3月 7 2013</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux-Secure/">Linux Secure</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2013/03/07/ssh/">ssh基础篇</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>SSH-安全登录服务,主要用于远程登录管理<br>1.监听tcp的22端口<br>2.相关软件包openssh-cline,openssh-server-5.3p1-81.el6.x86_64<br>3.配置文件位置在/etc/ssh中,ssh_config是客户端配置文件,sshd_config是服务端配置文件,默认通过公私钥的方式加密<br>当客户端连接时会在本地家目录生成一个公钥</p>
<p>当我们要同时分发文件到多台服务器的时候当我们一台一台登录的时候比较麻烦.这是我们可以通过生成公私钥的方式,把公钥分发到每一台host,这样我们不用每次输入密码了,一下是步骤</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ssh-keygen   生成密钥</div><div class="line">ssh-copy-id  -i  ~<span class="regexp">/.ssh/</span>*.pub user<span class="variable">@host</span>  把生成的公钥传到客户端,这样就不用每次数据密码了.</div></pre></td></tr></table></figure>

<p>ssh常用的命令:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt"></span></span></div><div class="line">ssh user@host     登录远程主机</div><div class="line">ssh user@host   "command"   本地操作远程主机执行命令</div><div class="line">ssh user@host   "command" &gt; /tmp/     把远程服务器执行的结果重定向到本地tmp目录下</div><div class="line"><span class="input"><span class="prompt">tar cf - dir | ssh IP "cat - &gt;</span> /tmp/dir1.tar<span class="string">"   把本地的文件或者目录传输到远程服务器,并且是打包的</span></span></div><div class="line">ssh IP "tar xzf - -<span class="constant">C</span> /tmp<span class="string">" &lt; /dir/dd.tar.gz   把本地的tar包解压到远程目录</span></div><div class="line">tar cf - . |ssh root@host "tar xf - -<span class="constant">C</span> /tmp<span class="string">"  把本地的数据打包传输到远程服务器,所有的目录树结构和权限是一样的</span></div></pre></td></tr></table></figure>

<p>如果想批量执行可以这么操作</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">cat &lt;&lt;<span class="constant">END</span> |ssh <span class="constant">IP</span></div><div class="line">&gt;service httpd restart  重启httpd服务</div><div class="line">&gt;sleep <span class="number">2</span>                     停顿<span class="number">2</span>s</div><div class="line">&gt;service sshd restart    重启sshd服务</div><div class="line">&gt;<span class="constant">ENDF</span>                          退出并执行</div></pre></td></tr></table></figure>

<p>ssh转发功能,解决不加密的服务进行转发</p>
<p>ssh IP -L 2025:localhost:25    通过本地2025端口去连接远程的25号端口</p>
<p>远程执行本地脚本<br>ssh  user@localhost bash &lt; /tmp/shell.sh</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://cloudbps.com/2013/03/07/ssh/" data-id="ro9dr2hcmh0ct9xl" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/系统安全/">系统安全</a></li></ul>

    </footer>
  </div>
  
</article>


  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/5/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span>
    </nav>
  
</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 Tom.liu<br>
      <a href="https://github.com/ken8203/hexo-theme-alberta" target="_blank">Alberta</a> by <a href="http://jaychung.tw" target="_blank">jaychung</a>. Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Thank <a href="http://subtlepatterns.com/" target="_blank">Subtlepatterns</a>
    </div>
  </div>
</footer>
    </div>
    
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="//imsky.github.io/holder/holder.js"></script>

  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">

  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>



<script src="/js/script.js" type="text/javascript"></script>


  </div>
</body>
</html>